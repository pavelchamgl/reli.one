{% extends "emails/base_email.html" %}

{% block content %}
  <table width="100%" cellpadding="0" cellspacing="0" style="font-family:Arial, sans-serif; font-size:14px; color:#333333; border-collapse:collapse; width:100%;">
    <tr>
      <td style="padding-bottom:10px;">
        <h2 style="margin:0; font-size:20px;">NEW ORDER CONFIRMATION</h2>
      </td>
    </tr>

    <!-- Инструкции -->
    <tr>
      <td style="padding:10px 0; border-top:2px solid #FFD247;">
        <h3 style="margin:0 0 10px 0; font-size:16px;">Instructions for the Seller:</h3>
        <ol style="padding-left:20px; margin:0;">
          <li style="margin-bottom:8px;">Please confirm receipt and order readiness within <strong>one business day (24 hours)</strong> of receiving this message by email to <a href="mailto:office@reli.one" style="color:#333333; text-decoration:none;"><strong>office@reli.one</strong></a></li>
          <li style="margin-bottom:8px;">Ensure the order is packed within <strong>3 business days</strong> after confirmation, and confirm completion by email to <a href="mailto:office@reli.one" style="color:#333333; text-decoration:none;"><strong>office@reli.one</strong></a></li>
          <li style="margin-bottom:8px;">Dispatch the packed order to the courier using one of the following options:
            <ul style="margin:4px 0 8px 20px; padding:0;">
              <li>Drop it off at a designated courier drop-off point;</li>
              <li>Or schedule a courier pickup from your address.</li>
            </ul>
          </li>
        </ol>
        <p style="margin:8px 0;">If you have any questions regarding shipping, please contact the courier’s customer support for the respective order group below.</p>
      </td>
    </tr>

    {% for group in groups %}
      <!-- Информация по заказу -->
      <tr>
        <td style="padding:20px 0 10px 0; border-top:2px solid #FFD247;">
          <h3 style="margin:0; font-size:16px;">Order No.: {{ group.order_number }}</h3>
          <p style="margin:5px 0;">Delivery Method: {{ group.delivery_type }} {{ group.courier_service }}</p>

          {% if group.delivery_address %}
            <p style="margin:5px 0;"><strong>Delivery address:</strong> {{ group.delivery_address }}</p>
          {% elif group.pickup_point_info %}
            <p style="margin:5px 0;"><strong>Pickup Point:</strong> {{ group.pickup_point_info }}</p>
          {% endif %}

          {% if group.courier_support_url %}
            <p style="margin:5px 0;">
              <strong>Courier support:</strong>
              <a href="{{ group.courier_support_url }}" target="_blank" rel="noopener" style="color:#0066cc;">
                Contact {{ group.courier_short }}
              </a>
            </p>
          {% endif %}
        </td>
      </tr>

      <!-- Таблица товаров -->
      <tr>
        <td>
          <table cellpadding="0" cellspacing="0" width="100%" style="border-collapse:collapse; margin-top:10px;">
            <thead>
              <tr>
                <th style="background-color:#FFD247; color:#000000; padding:10px; border:1px solid #dddddd; text-align:left;">Item</th>
                <th style="background-color:#FFD247; color:#000000; padding:10px; border:1px solid #dddddd; text-align:left;">Quantity</th>
                <th style="background-color:#FFD247; color:#000000; padding:10px; border:1px solid #dddddd; text-align:left;">Price per unit</th>
                <th style="background-color:#FFD247; color:#000000; padding:10px; border:1px solid #dddddd; text-align:left;">Total Price</th>
              </tr>
            </thead>
            <tbody>
              {% for p in group.products %}
                <tr>
                  <td style="padding:10px; border:1px solid #dddddd;">
                    <div class="mobile-label" style="display:none; font-weight:bold;">Item</div>
                    <div>{{ p.product_name }}</div>
                  </td>
                  <td style="padding:10px; border:1px solid #dddddd;">
                    <div class="mobile-label" style="display:none; font-weight:bold;">Quantity</div>
                    <div>{{ p.quantity }}</div>
                  </td>
                  <td style="padding:10px; border:1px solid #dddddd;">
                    <div class="mobile-label" style="display:none; font-weight:bold;">Price per unit</div>
                    <div>{{ p.unit_price }} €</div>
                  </td>
                  <td style="padding:10px; border:1px solid #dddddd;">
                    <div class="mobile-label" style="display:none; font-weight:bold;">Total Price</div>
                    <div>{{ p.total_price }} €</div>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
          <p style="margin-top:10px;"><strong>Total for this order:</strong> {{ group.group_total }} €</p>
        </td>
      </tr>
    {% endfor %}

    {% if parcels %}
    <tr>
      <td style="padding:20px 0 10px 0; border-top:2px solid #FFD247;">
        <h3 style="margin:0 0 10px 0; font-size:16px;">SHIPMENT DETAILS</h3>
        {% for parcel in parcels %}
          <p style="margin:5px 0;">
            <strong>Tracking Number:</strong> {{ parcel.courier_short }} — {{ parcel.tracking_number }}
          </p>
          <ul style="margin:0 0 10px 20px; padding:0;">
            {% for item in parcel.items %}
              <li style="margin:2px 0;">{{ item.quantity }}× {{ item.product_name }} (SKU: {{ item.sku }})</li>
            {% endfor %}
          </ul>
        {% endfor %}
        <p style="margin-top:10px;">* Shipping labels (PDF) are attached to this email.</p>
      </td>
    </tr>
    {% endif %}
  </table>
{% endblock %}
